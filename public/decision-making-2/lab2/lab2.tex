% !TEX program = xelatex

\input{../../../preamble}
\input{../../../commons}

\newcommand{\labnumber}{2} % second lab
\input{../preamble}
\input{../constants}

\usepackage{systeme}
\usepackage{longtable,tabu}
\usepackage{multirow}
\usepackage{array,multirow}
\usepackage{pdflscape}
\usepackage{afterpage}
\usepackage{bm}

\graphicspath{{../figures/}}

\begin{document}
\Russian

\input{../title}
\addtocounter{page}{1}

\textbf{Тема}: степени согласованности мнений экспертов.

\textbf{Цель}: изучение процесса оценки степени согласованности мнений экспертов.

\textbf{Задание}: произвести необходимые расчеты и оценить степень согласованности мнений экспертов с использованием коэффициента конкордации Кендалла-Б.Смита и коэффициента корреляции Спирмена; сравнить полученные результаты.

\textbf{Индивидуальное задание на лабораторную работу}:

Вариант №1

\begin{table}[H]
	\caption{Оценка суждений экспертов}
	\label{tab:expert_char}
	\begin{tabular}{|c|c|c|c|}
		\hline
		Объекты & Эксперт 1 & Эксперт 2 & Эксперт 3 \\ \hline
		1       & 7         & 10        & 6         \\ \hline
		2       & 1         & 9         & 4         \\ \hline
		3       & 7         & 2         & 6         \\ \hline
		4       & 3         & 3         & 3         \\ \hline
		5       & 8         & 8         & 9         \\ \hline
		6       & 5         & 10        & 8         \\ \hline
	\end{tabular}
\end{table}

\subsection{Коэффициент конкордации Кендалла-Ю.Смита}
{
	\itshape
	Рассчитать коэффициент конкордации Кендалла-Ю.Смита.
}

Пусть имеется 6 объектов и коллектив из 3-х экспертов.
Мнения экспертов различны, данные приведены в таблице~\ref{tab:expert_char}.

Матрица рангов, полученная из таблицы~\ref{tab:expert_char}, и вычисления, необходимые для определения $W$, представлены в таблице~\ref{tab:expert_ran}.

\begin{table}[H]
	\caption{Ранжировка объектов}
	\label{tab:expert_ran}
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		\multirow{3}{*}{$i$} & \multicolumn{3}{c|}{$R_{ij}$} & \multirow{3}{*}{$\bigg(\sum^m_{j=1}R_{ij} - \frac{m(n+1)}{2}\bigg)^2$}                   \\ \cline{1-4}
		                     & \multicolumn{3}{c|}{$j$}      &                                                                                          \\ \cline{1-4}
		                     & 1                             & 2                                                                      & 3     &         \\ \hline
		1                    & $4.5$                         & $5.5$                                                                  & $3.5$ & $9$     \\ \hline
		2                    & $1.0$                         & $4.0$                                                                  & $2.0$ & $12.25$ \\ \hline
		3                    & $4.5$                         & $1.0$                                                                  & $3.5$ & $2.25$  \\ \hline
		4                    & $2.0$                         & $2.0$                                                                  & $1.0$ & $30.25$ \\ \hline
		5                    & $6.0$                         & $3.0$                                                                  & $6.0$ & $20.25$ \\ \hline
		6                    & $3.0$                         & $5.5$                                                                  & $5.0$ & $9$     \\ \hline
	\end{tabular}
\end{table}

Ранговый коэффициент конкордации рассчитывается по формуле:
\[
	W = \frac{12}{m^2(n^3-n) - m \sum^k_{j=1}T_j} \cdot \sum_{i=1}^n\bigg(\sum^m_{i=1}R_{ij} - \frac{m(n+1)}{2}\bigg)^2,
\]
\begin{description}
	\item[где] $R_{ij}$ --- ранг $i$-го элемента в $X_j$ выборке;
	\item $T_j = \sum^k_{i=1} (t^3_i - t_i)$ ($k$ --- количество связок, $t_i$ --- размер связки);
	\item $m=3$;
	\item $n=6$.
\end{description}

Зная, что $\sum_{i=1}^n\bigg(\sum^m_{i=1}R_{ij} - \frac{m(n+1)}{2}\bigg)^2 = 83$, рассчитаем $W$:
\[
	W = \frac{12}{9(216-6)-3 \cdot 18} \cdot 83 = 0.5424.
\]

Имея в виду, что при доверительной вероятности $\alpha=0.95$ и степени свободы $f=n-1=5$ квантиль распределения $\chi^2 = 11.07$, по формуле $W_\alpha=\frac{\chi^2}{m(n-1)}$ находим критическое значение $W_\alpha = 0.738$.

Так как $W<W_\alpha$, то с вероятностью $\alpha$ можно утверждать, что согласованность экспертов незначима.

% http://www.machinelearning.ru/wiki/index.php?title=%D0%9A%D0%BE%D1%8D%D1%84%D1%84%D0%B8%D1%86%D0%B8%D0%B5%D0%BD%D1%82_%D0%BA%D0%BE%D1%80%D1%80%D0%B5%D0%BB%D1%8F%D1%86%D0%B8%D0%B8_%D0%A1%D0%BF%D0%B8%D1%80%D0%BC%D0%B5%D0%BD%D0%B0
\subsection{Коэффициент парной корреляции Спирмена}
{
	\itshape
	Рассчитать коэффициент парной корреляции Спирмена.
}

Пусть имеется 6 объектов и коллектив из 3-х экспертов.
Мнения экспертов различны, данные приведены в таблице~\ref{tab:expert_char}.

Проранжируем имеющиеся данные и разделим их на 3 группы, рассчитаем коэффициент парной ранговой корреляции Спирмена/

\begin{table}[H]
	\caption{Расчет коэффициента корреляции Спирмена}
	\label{tab:expert_spir1}
	\begin{tabular}{|c|c|c|c|}
		\hline
		$i$ & $x$    & $y$    & $(x_i-(n+1)/2)(y_i-(n+1)/2)$ \\ \hline
		1   & $5.50$ & $3.50$ & $4.00$                       \\ \hline
		2   & $4.00$ & $2.00$ & $4.00$                       \\ \hline
		3   & $1.00$ & $3.50$ & $6.25$                       \\ \hline
		4   & $2.00$ & $1.00$ & $1.00$                       \\ \hline
		5   & $3.00$ & $6.00$ & $9.00$                       \\ \hline
		6   & $5.50$ & $5.00$ & $0.25$                       \\ \hline
	\end{tabular}
\end{table}

Сумма $(x_i-(n+1)/2)(y_i-(n+1)/2)$ равна $4.75$.

При наличии связок коэффициент корреляции Спирмена следует вычислять следующим образом:
\begin{align*}
	\rho   & = \frac{\sum_{i=1}^n{(R_i-(n+1)/2)(S_i-(n+1)/2)}}{n(n-1)(n+1)-\Delta},                      \\
	\Delta & =\frac{1}{2}\sum_{l=1}^q{u_i^x((u_i^x)^2-1)+\frac{1}{2}\sum_{i=1}^{f}{u_i^y((u_i^y)^2-1)}},
\end{align*}
\begin{description}
	\item[где] $q$ и $f$ --- количество связок в выборках $x$ и $y$,
	\item $u^x_1, \ldots, u^x_q, u^y_1, \ldots, u^y_f$ --- их размеры.
\end{description}

Рассчитаем коэффициент парной ранговой корреляции Спирмена:
\begin{align*}
	\Delta & = \frac{1}{2} 2 (2^2-1) + \frac{1}{2} 2 (2^2-1) = 6, \\
	\rho   & = \frac{4.75}{6(6-1)(6+1)-6} =                       \\
	       & = \frac{4.75}{204} = 0.023.
\end{align*}

Полученное значение согласованности близко к нулю, потому согласованность является незначительной.

\begin{table}[H]
	\caption{Расчет коэффициента корреляции Спирмена}
	\label{tab:expert_spir2}
	\begin{tabular}{|c|c|c|c|}
		\hline
		$i$ & $x$    & $y$    & $(x_i-(n+1)/2)(y_i-(n+1)/2)$ \\ \hline
		1   & $4.50$ & $3.50$ & $1.00$                       \\ \hline
		2   & $1.00$ & $2.00$ & $1.00$                       \\ \hline
		3   & $4.50$ & $3.50$ & $1.00$                       \\ \hline
		4   & $2.00$ & $1.00$ & $1.00$                       \\ \hline
		5   & $6.00$ & $6.00$ & $0.00$                       \\ \hline
		6   & $3.00$ & $5.00$ & $4.00$                       \\ \hline
	\end{tabular}
\end{table}

Сумма $(x_i-(n+1)/2)(y_i-(n+1)/2)$ равна $13.00$.

Рассчитаем коэффициент парной ранговой корреляции Спирмена:
\begin{align*}
	\Delta & = \frac{1}{2} 2 (2^2-1) + \frac{1}{2} 2 (2^2-1) = 6, \\
	\rho   & = \frac{13.00}{6(6-1)(6+1)-6} =                      \\
	       & = \frac{13.00}{204} = 0.063.
\end{align*}

Полученное значение согласованности близко к нулю, потому согласованность является незначительной.

\begin{table}[H]
	\caption{Расчет коэффициента корреляции Спирмена}
	\label{tab:expert_spir3}
	\begin{tabular}{|c|c|c|c|}
		\hline
		$i$ & $x$    & $y$    & $(x_i-(n+1)/2)(y_i-(n+1)/2)$ \\ \hline
		1   & $4.50$ & $5.50$ & $1.00$                       \\ \hline
		2   & $1.00$ & $4.00$ & $9.00$                       \\ \hline
		3   & $4.50$ & $1.00$ & $12.25$                      \\ \hline
		4   & $2.00$ & $2.00$ & $0.00$                       \\ \hline
		5   & $6.00$ & $3.00$ & $9.00$                       \\ \hline
		6   & $3.00$ & $5.50$ & $6.25$                       \\ \hline
	\end{tabular}
\end{table}

Сумма $(x_i-(n+1)/2)(y_i-(n+1)/2)$ равна $-1.75$.

Рассчитаем коэффициент парной ранговой корреляции Спирмена:
\begin{align*}
	\Delta & = \frac{1}{2} 2 (2^2-1) + \frac{1}{2} 2 (2^2-1) = 6, \\
	\rho   & = -\frac{1.75}{6(6-1)(6+1)-6} =                      \\
	       & = -\frac{1.75}{204} = -0.008.
\end{align*}

Полученное значение согласованности близко к нулю, потому согласованность является незначительной.

\subsection{Выводы}

В ходе лабораторной работы было изучено процесс оценки степени согласованности мнений эспертов, а также решены задачи, связанные с расчетом коэффициента конкордации Кендалла--Б.Смита и коэффициент парной ранговой корреляции Спирмена.

\end{document}
